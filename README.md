# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```

# Архитиктура приложения MVP (Model-View-Presenter)
- Model: представляет данные приложения и бизнес-логику. Она содержит всю необходимую информацию для 
работы приложения и обеспечивает доступ к данным через интерфейсы или методы.
- View: отображает интерфейс пользователя и передает события от пользователя 
(такие как нажатия кнопок, ввод текста и т.п.) презентеру.
- Presenter: является посредником между моделью и представлением. Он получает данные от модели, 
обрабатывает их и передает представление. Когда пользователь взаимодействует с представлением,
оно отправляет событие презентеру, который решает, какие изменения нужно внести в модель и представление.

# Интерфейсы:  

## Интерфейс IProduct
Предназначен для представления товара в магазине. Включает ключевые параметры продукта:
идентификатор, описание, изображение, наименование, категорию, стоимость

- id: string
- description: string
- image: string
- title: string
- category: string,
- price: number | null

## Интерфейс IOrderForm
Предназначен для формы заказа. Описывает способ оплаты, адресс, электронную почту, телефон и
общую стоимость товаров

- payment: string
- address: string
- email: string
- phone: number | string

## Интерфейс IOrderResult
Предназначен для результата заказа,содержит идентификатор и общую стоимость товаров

- id:string
- total:number

## Интерфейс IBasketModel
Описывает структуру и методы, необходимые для управления корзиной товаров.

### Поля:
- basketItems: IProduct[] - Массив товаров, находящихся в корзине. Каждый элемент массива должен соответствовать интерфейсу IProduct.

### Методы:
- addProductToBasket(data: IProduct): void - Добавляет товар в корзину. data представляет собой объект типа IProduct, который необходимо добавить.
- removeProductToBasket(item: IProduct): void - Удаляет товар из корзины. item представляет собой объект типа IProduct, который необходимо удалить.
- clearBasket(): void - Полностью очищает корзину, удаляя все товары.
- basketCounter(): number - Возвращает количество товаров в корзине.
- totalPriceProducts(): number - Возвращает общую стоимость всех товаров в корзине.

## Интерфейс ICardsModel

Описывает структуру данных и методы для управления списком карточек товаров.

### Поля:
- productCards: IProduct[] - Массив карточек товаров, где каждый элемент является объектом IProduct.
- clickedCard: IProduct | null - Объект IProduct, представляющий выбранную карточку товара для отображения в модальном окне предпросмотра. Может быть null, если ни одна карточка не выбрана.

### Методы:
- setPreview(item: IProduct): void - Устанавливает выбранную карточку товара для предпросмотра и запускает событие modalCard:open.

## Интерфейс IPayForm

Расширяет интерфейс IOrderForm и определяет структуру данных и методы для работы с формой оформления заказа и оплаты.

### Поля:
Наследует поля от IOrderForm. Включает:

- payment: string - Способ оплаты, выбранный пользователем.
- email: string - Адрес электронной почты пользователя.
- phone: string - Номер телефона пользователя.
- address: string - Адрес доставки заказа.
- formErrors: FormErrors - Объект, содержащий ошибки валидации полей формы.

### Методы:
- validateOrder(): boolean - Проверяет валидность полей, связанных с заказом (адрес и способ оплаты).
- validateContactInfo(): boolean - Проверяет валидность контактной информации (email и телефон).
- setAddress(field: string, value: string): void - Устанавливает значение поля адреса.
- setContact(field: string, value: string): void - Устанавливает значение контактного поля (email или телефон).
- clearForm(): void - Очищает форму, сбрасывая все поля.

# View

## Интерфейс IBasket
Описывает структуру и методы для представления и управления отображением корзины.

### Поля:
- basket: HTMLElement - Элемент представляющий контейнер корзины.
- basketTitle: HTMLElement - Элемент отображающий заголовок корзины.
- basketList: HTMLElement - Элемент содержащий список товаров в корзине.
- basketButton: HTMLButtonElement - Кнопка для перехода к оформлению заказа.
- basketPrice: HTMLElement - Элемент отображающий общую стоимость товаров в корзине.

### Методы:
- displayBasket(items: HTMLElement[]): HTMLElement - Отображает список товаров в корзине. 
- displayBasketSum(sum: number): void - Отображает общую сумму товаров в корзине. 

## Интерфейс IPage
Описывает структуру данных и методы для управления отображением страницы, в шапке содержащей информацию о корзине.

### Поля:
- basketHeaderButton: HTMLButtonElement - Кнопка в шапке для открытия корзины.
- basketHeaderCounter: HTMLElement - Элемент отображающий количество товаров в корзине.
- catalog: HTMLElement: Контейнер для карт

### Методы:
- displayBasketCount(value: number): void - Отображает количество товаров в корзине.

## Интерфейс ICard
Определяет интерфейс для отображения карточки товара.

### Методы:
- displayCard(data: IProduct): HTMLElement - Отображает информацию о продукте в карточке.

## Интерфейс IContactInfo
Описывает структуру данных и методы для управления отображением формы контактной информации.

### Поля:
- contactForm: HTMLFormElement - Элемент представляющий форму контактной информации.
- contactInputs: HTMLInputElement[] - Массив элементов представляющих поля ввода в форме.
- contactButton: HTMLButtonElement - Элемент представляющий кнопку отправки формы.
- contactFormErrors: HTMLElement - Элемент отображающий ошибки валидации формы.
- displayContact(): HTMLElement - Метод отображения контактной формы.

### Методы:
- displayContact(): HTMLElement - Возвращает элемент контактной формы.
- setValid(value: boolean): void - Устанавливает атрибут disabled для кнопки отправки формы в зависимости от значения value. 
- setFormErrors(value: string): void - Устанавливает текст для элемента отображающего ошибки валидации формы.
- clearContact(): void - Очищает поля формы контактной информации.
- 
## Интерфейс IOrder
Описывает структуру данных и методы для управления отображением формы оформления заказа.

### Поля:
- orderForm: HTMLFormElement - Элемент представляющий форму оформления заказа.
- orderButtons: HTMLButtonElement[] - Массив элементов представляющих кнопки выбора способа оплаты.
- buttonSubmit: HTMLButtonElement - Элемент, представляющий кнопку отправки заказа.
- formErrors: HTMLElement - Элемент, отображающий ошибки валидации формы.

### Методы:
- displayOrder(): HTMLElement - Возвращает элемент формы оформления заказа.
- setPaymentChoice(paymentMethod: string): void - Активирует кнопку выбранного способа оплаты и деактивирует остальные, отправляет событие order:payment с выбранным способом оплаты.
- setValid(value: boolean): void - Устанавливает атрибут disabled для кнопки отправки заказа в зависимости от значения value. Если value равно true, кнопка активна, иначе - заблокирована.
- setFormErrors(errors: string): void - Устанавливает текст для элемента, отображающего ошибки валидации формы.
- clearOrder(): void - Очищает поля формы оформления заказа.

## Интерфейс ISuccess
Описывает структуру данных и методы для управления отображением окна подтверждения успешного оформления заказа.

### Поля:
- success: HTMLElement - Элемент представляющий контейнер окна подтверждения успешного оформления заказа.
- successText: HTMLElement - Элемент отображающий текст сообщения об успешном списании средств.
- button: HTMLButtonElement - Элемент представляющий кнопку закрытия окна.

### Методы:
- displaySuccess(total: number): HTMLElement - Отображает окно успешного оформления заказа. Принимает общую сумму списанных средств и подставляет ее в текст сообщения. 

## Интерфейс IModalData
Описывает структуру данных, необходимых для отображения модального окна.

### Поля:
- content: HTMLElement - Элемент который будет отображаться внутри модального окна.

# Базовые классы:

## Api
Класс Api нужен для работы с запросами к серверу

- handleResponse: обрабатывает ответ от сервера, в случае успеха возрващает данные
- get: выполняет GET запрос, затем обрабатывает ответ через handleresponse
- post: выполняет POST запрос, затем обрабатывается ответ через handleresponse

## EventEmitter
Брокер сообщений, устанавливает, вызывает и снимает слушатели событий. Предствляет собой Presenter, обеспечивая
связь между моделями данных и пользовательским интерфейсом, синхронизацию данных и визуализацию при 
возникновении определенных событий, координируя взаимодействие между ними.

Паттерн Observer позволяет создать зависимость между объектами-наблюдателями и одним объектом-источником.
При изменении состояния источника все наблюдатели автоматически об этом оповещаются.

Такой подход удобен, когда разные части системы должны оставаться независимыми друг от друга, 
но при этом должны обмениваться информацией.

- on: добавляет новый обработчик к указанному событию. Если для этого события еще нет подписчиков, создается новая коллекция
- off: удаляет указанный обработчик из списка подписчиков конкретного события. Если после удаления обработчиков список 
становится пустым, удаляется вся запись о событии
- emit: инициирует событие, вызывая всех подписчиков, связанных с этим событием
- trigger: возвращает функцию, которая инициирует указанное событие при своем вызове.

# Model:

## ApiModel 
Класс ApiModel является расширением базового класса Api и предназначен для взаимодействия с сервером, 
получения списка товаров и отправки заказов. Он реализует интерфейс IApiModel.

КОнструктор:

constructor(baseUrl: string, cdn: string, options?: RequestInit)

- baseUrl (string): Базовый URL для запросов к серверу.
- cdn (string): URL для подстановки пути к изображениям.
- options (RequestInit): Дополнительные опции для запросов.

### Поля:

- cdn: string: URL  для подстановки пути к изображениям.

### Методы:

- getCardList(): Promise<IProduct[]> - Получает список товаров с сервера.
- postOrder(order: IOrderForm): Promise<IOrderResult> - Отправляет заказ на сервер.

## BasketModel  
Реализует интерфейс IBasketModel. Представляет модель корзины товаров.

Конструктор:

constructor(events: IEvents)

- events: IEvents - объект для управления событиями

### Поля:
- basketItems: IProduct[] - массив карточек товара

### Методы:

- get basketItems(): IProduct[] - Геттер для получения массива товаров в корзине.
- set basketItems(arr: IProduct[]): void - Сеттер для установки массива товаров в корзине. При установке вызывает 
  событие 'basket:changed' для уведомления об изменениях.
- addProductToBasket(data: IProduct): void - Добавляет товар в корзину. Добавляет товар в массив _basketItems и 
  вызывает событие 'basket:changed'.
- removeProductToBasket(item: IProduct): void - Удаляет товар из корзины. Находит индекс товара по id и удаляет его 
  из массива _basketItems. Вызывает событие 'basket:changed'.
- basketCounter(): number - Возвращает количество товаров в корзине. Возвращает длину массива basketItems.
- totalPriceProducts(): number - Возвращает общую стоимость всех товаров в корзине. Использует метод reduce для 
  суммирования цен всех товаров.
- clearBasket(): void - Полностью очищает корзину. Устанавливает _basketItems в пустой массив и вызывает событие 
  'basket:changed'.


## Класс CardsModel
Реализует интерфейс ICardsModel. Представляет модель списка карточек товаров.

Конструктор:

constructor(events: IEvents)

- events: IEvents - объект для управления событиями

### Поля:

- _productCards: IProduct[] -  свойство содержащее массив карточек товаров.
- clickedCard: IProduct | null - объект представляющий выбранную карточку товара. 

### Методы:

- get productCards(): IProduct[] - Геттер для получения массива карточек товаров 
- set productCards(arr: IProduct[]): void - Сеттер для установки массива карточек товаров. При установке массива, вызывает событие products:changed для уведомления об изменениях.
- setPreview(item: IProduct): void - Устанавливает выбранную карточку товара для предпросмотра. 

## Класс PayForm

Реализует интерфейс IPayForm.  Представляет модель формы оформления заказа и оплаты.

Конструктор:

constructor(events: IEvents)

- events: IEvents - объект для управления событиями

### Поля:

- payment: string - Способ оплаты, выбранный пользователем. 
- email: string - Адрес электронной почты пользователя. 
- phone: string - Номер телефона пользователя. 
- address: string - Адрес доставки заказа. 
- formErrors: FormErrors - Объект, содержащий ошибки валидации полей формы. 

### Методы:

- setPayment(payment: string): void - Устанавливает способ оплаты.
- setAddress(value: string): void - Устанавливает значение поля адреса.
- validateOrder(): boolean - Проверяет валидность полей адреса и способа оплаты. Устанавливает ошибки в formErrors и публикует событие formErrors:changed. 
- setContact(field: string, value: string): void - Устанавливает значение поля email или phone и вызывает событие orderContacts:changed.
- validateContactInfo(): boolean - Проверяет валидность контактной информации (email и телефон). 
- clearForm(): void - Очищает форму, сбрасывая все поля.

## Класс Basket
Реализует интерфейс IBasket. Представляет визуальное отображение корзины товаров.

Конструктор:

constructor(template: HTMLTemplateElement, events: IEvents)

- template: HTMLTemplateElement - HTML-шаблон для создания структуры корзины.
- events: IEvents - объект для управления событиями

### Поля:
- basket: HTMLElement - Корневой элемент представляющий контейнер корзины. Создается клонированием элемента из template.
- basketTitle: HTMLElement - Элемент отображающий заголовок корзины. Получается из basket.
- basketList: HTMLElement - Элемент содержащий список товаров в корзине. Получается из basket.
- basketButton: HTMLButtonElement - Кнопка для перехода к оформлению заказа. Получается из basket. Подписывается на событие click, которое вызывает событие order:open.
- basketPrice: HTMLElement - Элемент отображающий общую стоимость товаров в корзине. Получается из basket.

### Методы:
- displayBasket(items: HTMLElement[]): HTMLElement - Отображает список товаров в корзине.
- displayBasketSum(sum: number): void - Отображает общую сумму товаров в корзине. 
- getBasketContent(): HTMLElement - Возвращает элемент корзины.

## Класс Page
Реализует интерфейс IPage. Представляет шапку страницы с информацией о корзине.

Конструктор:

constructor(events: IEvents)

- events: IEvents - объект для управления событиями

### Поля:
- basketHeaderButton: HTMLButtonElement - Кнопка в шапке для открытия корзины. Подписывается на событие click, которое вызывает событие basket:open.
- basketHeaderCounter: HTMLElement - Элемент отображающий количество товаров в корзине. 

### Методы:
- displayBasketCount(value: number): void - Отображает количество товаров в корзине в шапке. 

## Класс ProductView
Базовый класс для представления отображения информации о продукте.

Конструктор:

constructor(template: HTMLTemplateElement, events: IEvents, actions?: IActions)

- template: HTMLTemplateElement - HTML-шаблон для создания структуры карточки товара.
- events: IEvents - объект для управления событиями
- actions: IActions (optional) - объект содержащий обработчики событий.

### Поля:
- _element: HTMLElement -элемент для представления карточки товара. 
- _title: HTMLElement - элемент отображающий название товара. 
- _price: HTMLElement - элемент отображающий цену товара. 

### Методы:

- protected setPrice(value: number | null): string - Преобразует числовое значение цены в строковое представление. Если value равно null, возвращает строку "Бесценно", иначе возвращает строку количества синапсов.
- render(data: IProduct): HTMLElement - Заполняет элементы данными о продукте и возвращает корневой элемент 

## Класс Card
Расширяет класс ProductView и реализует интерфейс ICard. Представляет карточку товара.

Конструктор:

constructor(template: HTMLTemplateElement, events: IEvents, actions?: IActions)

- template: HTMLTemplateElement - HTML-шаблон для создания структуры карточки товара.
- events: IEvents - объект для управления событиями
- actions: IActions (optional) - объект содержащий обработчики событий.

### Поля:
- _cardImage: HTMLImageElement - (protected) Элемент отображающий изображение товара. Получается из _element.
- _cardCategory: HTMLElement - (protected) Элемент отображающий категорию товара. Получается из _element.
- _cardDescription: Map<string, string> - (protected) Соответствие между текстовым названием категории и CSS-классом.

### Методы:
- private setCategory(value: string): void - Устанавливает CSS-класс для категории товара в зависимости от ее названия.
- displayCard(data: IProduct): HTMLElement - Отображает информацию о продукте в карточке. Заполняет элементы данными о продукте и возвращает корневой элемент.

## Класс CardPreview
Расширяет класс Card. Представляет карточку товара для предпросмотра.

Конструктор:

constructor(template: HTMLTemplateElement, events: IEvents, actions?: IActions)

- template: HTMLTemplateElement - HTML-шаблон для создания структуры карточки товара (предпросмотра).
- events: IEvents - объект для управления событиями
- actions: IActions (optional) - Объект, содержащий обработчики событий.

### Поля:
- text: HTMLElement - Элемент отображающий описание товара. 
- _button: HTMLButtonElement - Кнопка для добавления товара в корзину. Подписывается на событие click, которое вызывает событие basket:itemAdd.

### Методы:
- private notSale(data: IProduct, basketDuplicate: boolean): string - Определяет текст кнопки и ее состояние в зависимости от наличия цены у продукта и наличия товара в корзине.
- displayPreview(data: IProduct): HTMLElement - Отображает информацию о продукте в карточке предпросмотра.  Заполняет элементы данными о продукте и возвращает элемент.

## Класс BasketItem
Расширяет класс ProductView.  Представляет элемент товара в корзине.

Конструктор:

constructor(template: HTMLTemplateElement, events: IEvents, actions?: IActions)

- template: HTMLTemplateElement - HTML-шаблон для создания элемента товара в корзине.
- events: IEvents - объект для управления событиями.
- actions: IActions (optional) - Объект, содержащий обработчики событий.

### Поля:
- index: HTMLElement - Элемент отображающий индекс товара в списке. 
- _button: HTMLButtonElement - Кнопка для удаления товара из корзины.

### Методы:
- displayBasketItem(data: IProduct, item: number): HTMLElement - Отображает информацию о товаре в элементе корзины. Устанавливает индекс товара и заполняет остальные элементы данными о товаре и возвращает корневой элемент.

## Класс ContactInfo
Реализует интерфейс IContactInfo. Представляет визуальное отображение формы контактной информации.

Конструктор:

constructor(template: HTMLTemplateElement, events: IEvents)

- template: HTMLTemplateElement - HTML-шаблон для создания структуры формы контактной информации.
- events: IEvents - объект для управления событиями.

### Поля:
- contactForm: HTMLFormElement - Элемент представляющий форму контактной информации. 
- contactInputs: HTMLInputElement[] - Массив элементов представляющих поля ввода в форме. Подписывается на событие input для каждого поля, которое вызывает событие contacts:change с данными о поле и его значении.
- contactButton: HTMLButtonElement - Элемент представляющий кнопку отправки формы. 
- contactFormErrors: HTMLElement - Элемент отображающий ошибки валидации формы. 

### Методы:
- displayContact(): HTMLElement - Возвращает элемент контактной формы.
- setValid(value: boolean): void - Устанавливает атрибут disabled для кнопки отправки формы в зависимости от значения value.
- setFormErrors(value: string): void - Устанавливает текст для элемента, отображающего ошибки валидации формы.
- clearContact(): void - Очищает поля формы контактной информации.

## Класс Order
Реализует интерфейс IOrder. Представляет визуальное отображение формы оформления заказа.

Конструктор:

constructor(template: HTMLTemplateElement, events: IEvents)

- template: HTMLTemplateElement - HTML-шаблон для создания структуры формы оформления заказа.
- events: IEvents - объект для управления событиями.

### Поля:
- orderForm: HTMLFormElement - Элемент представляющий форму оформления заказа. 
- orderButtons: HTMLButtonElement[] - Массив элементов представляющих кнопки выбора способа оплаты. Подписывается на событие click для каждой кнопки, которое вызывает метод setPaymentChoice с названием кнопки.
- buttonSubmit: HTMLButtonElement - Элемент представляющий кнопку отправки заказа. 
- formErrors: HTMLElement - Элемент отображающий ошибки валидации формы.

### Методы:
- displayOrder(): HTMLElement - Возвращает элемент формы оформления заказа.
- setPaymentChoice(paymentMethod: string): void - Активирует кнопку выбранного способа оплаты и деактивирует остальные.
- setValid(value: boolean): void - Устанавливает атрибут disabled для кнопки отправки заказа в зависимости от значения value.
- setFormErrors(errors: string): void - Устанавливает текст для элемента, отображающего ошибки валидации формы.
- clearOrder(): void - Очищает поля формы оформления заказа.

## Класс Modal
Класс обеспечиваает функциональность модального диалога. Он расширяет класс Component и предназначен для обработки 
событий, связанных с модальными окнами, таких как открытие и закрытие модального окна, а также блокировка обертки
страницы, когда модальное окно активно.

Конструктор:

constructor(container: HTMLElement, events: IEvents)

- container: HTMLElement - Элемент DOM, в котором будет отображаться модальное окно.
- events: IEvents - Объект, реализующий интерфейс IEvents. Используется для подписки на события и их обработки.

### Поля:
- _closeButton: HTMLButtonElement - Кнопка закрытия модального окна. Подписывается на событие click, которое вызывает метод close.
- _content: HTMLElement - Контейнер для отображения контента модального окна. 
- _pageWrapper: HTMLElement - Элемент представляющий обертку страницы. Используется для блокировки прокрутки страницы при открытом модальном окне.
- _keyDownHandler: (event: KeyboardEvent) => void -  Обработчик события keydown. Используется для закрытия модального окна при нажатии клавиши Escape.
- locked: boolean - Свойство, определяющее, заблокирована ли прокрутка страницы при открытом модальном окне.

### Методы:
- set content(value: HTMLElement) - Устанавливает контент модального окна
- open(): void - Открывает модальное окно. 
- close(): void - Закрывает модальное окно. 
- handleKeyDown(event: KeyboardEvent): void - Обработчик события keydown. Закрывает модальное окно при нажатии клавиши Escape.
- set locked(value: boolean): void - Устанавливает блокировку прокрутки страницы. 
- render(): HTMLElement - Переопределенный метод render класса Component. Открывает модальное окно (this.open()) и возвращает контейнер модального окна. Вызывает super.render() для выполнения базовой логики рендеринга

# Prsenter

## Инициализация приложения:

## Создание экземпляров классов:
- Создаются экземпляры классов ApiModel, EventEmitter, CardsModel, Modal, BasketModel, Basket, PayForm, Order, ContactInfo, Success, Page.
- Определяются шаблоны для карточек, предпросмотра, корзины, элементов корзины, формы заказа, контактной информации и окна успеха.

## Загрузка и отображение карточек:
- Приложение делает запрос к API с помощью метода apiModel.getCardList().
- Полученный список товаров сохраняется в модели cardsModel.productCards.
- При получении данных от API вызывается событие 'products:changed', которое запускает процесс рендеринга карточек товаров.
- Каждая карточка товара представлена экземпляром класса Card, который привязан к событию onClick для открытия детальной информации о товаре.

## Открытие превью карточки:
- Когда пользователь нажимает на карточку товара, вызывается событие 'product:select'.
- В модели cardsModel сохраняется информация о выбранной карточке с помощью метода setPreview.
- Запускается событие 'modalCard:open', которое создает экземпляр класса CardPreview и заполняет модальное окно информацией о товаре.
- Модальное окно отображается на экране с помощью вызова метода modal.render().

## Добавление товара в корзину:

- При клике на кнопку "В корзину" в модальном окне вызывается событие basket:itemAdd.
- В модели basketModel товар добавляется в корзину с помощью метода addProductToBasket.
- Обновляется счетчик товаров в шапке с помощью метода page.displayBasketCount.
- Модальное окно закрывается вызовом modal.close().

## Удаление товара из корзины:

- При клике на кнопку "Удалить" в элементе корзины вызывается событие basket:itemRemove.
- В модели basketModel товар удаляется из корзины с помощью метода removeProductToBasket.
- Вызывается событие 'basket:open', чтобы обновить содержимое корзины..

## Открытие корзины

- При открытии корзины событие 'basket:open' инициирует обновление её содержимого.
- Для каждого товара создается экземпляр класса BasketItem.
- Общая сумма товаров вычисляется и отображается с помощью методов basket.displayBasketSum и basket.displayBasket.
- Контент модального окна обновляется и оно отображается на экране.

## Открытие формы оформления заказа:

- При нажатии на кнопку "Оформить заказ" вызывается событие 'order:open'.
- Содержимое модального окна заменяется формой заказа, полученной из метода order.displayOrder.
- Форма заказа отображается на экране с помощью метода modal.render.

## Выбор способа оплаты:

- пПользователь выбирает способ оплаты, что вызывает событие 'orderPayment:request'.
- Способ оплаты сохраняется в модели payForm с помощью метода setPayment.
- В интерфейсе заказа отображается выбранный способ оплаты с помощью метода order.setPaymentChoice.
- Выполняется валидация формы заказа с помощью метода payForm.validateOrder.

## Изменение адреса доставки:

- Пользователь вводит адрес доставки, что вызывает событие 'orderAddress:request'.
- Адрес сохраняется в модели payForm с помощью метода setAddress.
- Выполняется валидация формы заказа с помощью метода payForm.validateOrder.

## Валидация формы и отображение ошибок:

- При изменении ошибок в форме вызывается событие 'formErrors:changed'.
- Проверяются ошибки для адреса, способа оплаты, email и телефона.
- На основе результатов проверки определяется валидность кнопок отправки заказа и контактной информации.
- Сообщения об ошибках формируются и отображаются в соответствующих полях формы.

## Открытие формы ввода контактной информации:

- При событии 'contacts:open' открывается форма ввода контактной информации.
- Содержимое модального окна заменяется на форму контактов, полученную из метода contacts.displayContact.
- Форма отображается на экране с помощью метода modal.render.

## Изменение контактной информации:

- При изменении полей email или phone вызывается событие 'contacts:request'.
- Данные сохраняются в модели payForm с помощью метода setContact.
- Выполняется валидация контактной информации с помощью метода payForm.validateContactInfo.

## Отправка данных и отображение окна успеха:

- После успешного заполнения всех полей формы заказа и контактной информации вызывается событие 'contacts:submit'.
- Заказ отправляется на сервер с использованием метода apiModel.postOrder.
- Если заказ успешно отправлен, отображается сообщение об успехе с помощью метода success.displaySuccess.
- Корзина очищается, и форма заказа сбрасывается.

## Закрытие окна успеха:

- При возникновении события success:close модальное окно закрывается вызовом modal.close().

## Блокировка и разблокировка прокрутки страницы:

- При возникновении события modal:open устанавливается modal.locked = true, что блокирует прокрутку страницы.
- При возникновении события modal:close устанавливается modal.locked = false, что разблокирует прокрутку страницы.